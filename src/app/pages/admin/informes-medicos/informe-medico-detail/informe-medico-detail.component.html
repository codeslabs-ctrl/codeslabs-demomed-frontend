<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2 class="mb-0">
            <i class="fas fa-file-medical text-primary me-2"></i>
            Detalle del Informe Médico
          </h2>
          <p class="text-muted mb-0">Información completa del informe médico</p>
        </div>
        <div>
          <button class="btn btn-outline-secondary me-2" (click)="volver()">
            <i class="fas fa-arrow-left me-1"></i>
            Volver
          </button>
          <button class="btn btn-primary" (click)="editarInforme()" *ngIf="informe">
            <i class="fas fa-edit me-1"></i>
            Editar
          </button>
        </div>
      </div>

      <!-- Loading -->
      <div *ngIf="cargando" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Cargando...</span>
        </div>
        <p class="mt-3 text-muted">Cargando información del informe...</p>
      </div>

      <!-- Error -->
      <div *ngIf="error" class="alert alert-danger">
        <i class="fas fa-exclamation-triangle me-2"></i>
        {{ error }}
      </div>

      <!-- Informe Details -->
      <div *ngIf="informe && !cargando" class="row">
        <!-- Información General -->
        <div class="col-lg-8">
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-info-circle text-primary me-2"></i>
                Información General
              </h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6">
                  <p><strong>Título:</strong> {{ informe.titulo }}</p>
                  <p><strong>Número:</strong> {{ informe.numero_informe }}</p>
                  <p><strong>Tipo:</strong> {{ obtenerTipoInformeTexto(informe.tipo_informe) }}</p>
                </div>
                <div class="col-md-6">
                  <p><strong>Estado:</strong>
                    <span class="badge" [ngClass]="obtenerClaseEstado(informe.estado)">
                      {{ obtenerEstadoTexto(informe.estado) }}
                    </span>
                  </p>
                  <p><strong>Fecha de Emisión:</strong> {{ formatearFecha(informe.fecha_emision) }}</p>
                  <p><strong>Fecha de Creación:</strong> {{ formatearFecha(informe.fecha_creacion) }}</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Contenido del Informe -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-file-alt text-primary me-2"></i>
                Contenido del Informe
              </h5>
            </div>
            <div class="card-body">
              <div class="informe-contenido" [innerHTML]="informe.contenido"></div>
            </div>
          </div>

          <!-- Observaciones -->
          <div class="card mb-4" *ngIf="informe.observaciones">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-sticky-note text-warning me-2"></i>
                Observaciones
              </h5>
            </div>
            <div class="card-body">
              <p>{{ informe.observaciones }}</p>
            </div>
          </div>
        </div>

        <!-- Información del Paciente y Médico -->
        <div class="col-lg-4">
          <!-- Paciente -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-user text-success me-2"></i>
                Información del Paciente
              </h5>
            </div>
            <div class="card-body">
              <p><strong>Nombre:</strong> {{ informe.pacientes?.nombres }} {{ informe.pacientes?.apellidos }}</p>
              <p><strong>Cédula:</strong> {{ informe.pacientes?.cedula }}</p>
              <p><strong>Email:</strong> {{ informe.pacientes?.email || 'No disponible' }}</p>
              <p><strong>Teléfono:</strong> {{ informe.pacientes?.telefono || 'No disponible' }}</p>
            </div>
          </div>

          <!-- Médico -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-user-md text-info me-2"></i>
                Información del Médico
              </h5>
            </div>
            <div class="card-body">
              <p><strong>Nombre:</strong> {{ informe.medicos?.nombres }} {{ informe.medicos?.apellidos }}</p>
              <p><strong>Especialidad:</strong> {{ informe.medicos?.especialidades?.nombre_especialidad || 'No disponible' }}</p>
              <p><strong>Cédula:</strong> {{ informe.medicos?.cedula || 'No disponible' }}</p>
            </div>
          </div>

          <!-- Anexos -->
          <div class="card mb-4" *ngIf="anexos.length > 0">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-paperclip text-secondary me-2"></i>
                Anexos ({{ anexos.length }})
              </h5>
            </div>
            <div class="card-body">
              <div class="list-group list-group-flush">
                <div class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let anexo of anexos">
                  <div>
                    <i class="fas fa-file me-2"></i>
                    {{ anexo.nombre_archivo }}
                  </div>
                  <button class="btn btn-sm btn-outline-primary" (click)="descargarAnexo(anexo)">
                    <i class="fas fa-download"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Acciones -->
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-cogs text-primary me-2"></i>
                Acciones
              </h5>
            </div>
            <div class="card-body">
              <div class="d-grid gap-2">
                <button class="btn btn-success" (click)="firmarInforme()" *ngIf="informe.estado === 'borrador'">
                  <i class="fas fa-signature me-1"></i>
                  Firmar Informe
                </button>
                <button class="btn btn-info" (click)="enviarInforme()" *ngIf="informe.estado === 'firmado'">
                  <i class="fas fa-paper-plane me-1"></i>
                  Enviar Informe
                </button>
                <button class="btn btn-warning" (click)="imprimirInforme()">
                  <i class="fas fa-print me-1"></i>
                  Imprimir
                </button>
                <button class="btn btn-secondary" (click)="duplicarInforme()">
                  <i class="fas fa-copy me-1"></i>
                  Duplicar
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

